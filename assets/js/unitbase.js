unitBaseStats =
[
    {
        "description": "Peasant",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Burning man",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Woodcutter",
        "health": 10000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Fletcher",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Tunneler",
        "health": 10000,
        "arrow_damage": 5000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Hunter",
        "health": 5000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Quarry mason",
        "health": 10000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Quarry grunt",
        "health": 10000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Quarry ox",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Pitch worker",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Wheat farmer",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Hops farmer",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Apple farmer",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Dairy farmer",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Miller",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Baker",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Brewer",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Poleturner",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Blacksmith",
        "health": 10000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Armourer",
        "health": 5000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Tanner",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "European archer",
        "health": 10000,
        "arrow_damage": 2000,
        "xbow_damage": 15000,
        "stone_damage": 1000
    },
    {
        "description": "European crossbowman",
        "health": 15000,
        "arrow_damage": 1500,
        "xbow_damage": 5000,
        "stone_damage": 750
    },
    {
        "description": "European spearman",
        "health": 10000,
        "arrow_damage": 3500,
        "xbow_damage": 15000,
        "stone_damage": 1800
    },
    {
        "description": "European pikeman",
        "health": 50000,
        "arrow_damage": 1000,
        "xbow_damage": 3000,
        "stone_damage": 500
    },
    {
        "description": "European maceman",
        "health": 15000,
        "arrow_damage": 1000,
        "xbow_damage": 5000,
        "stone_damage": 500
    },
    {
        "description": "European swordsman",
        "health": 25000,
        "arrow_damage": 150,
        "xbow_damage": 2200,
        "stone_damage": 150
    },
    {
        "description": "European knight",
        "health": 20000,
        "arrow_damage": 150,
        "xbow_damage": 2500,
        "stone_damage": 150
    },
    {
        "description": "Ladderman",
        "health": 5000,
        "arrow_damage": 1000,
        "xbow_damage": 2500,
        "stone_damage": 2500
    },
    {
        "description": "Engineer",
        "health": 5000,
        "arrow_damage": 2000,
        "xbow_damage": 10000,
        "stone_damage": 2000
    },
    {
        "description": "Iron miner1",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Iron miner2",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Priest",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Healer",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Drunkard",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Innkeeper",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Monk",
        "health": 15000,
        "arrow_damage": 4000,
        "xbow_damage": 7000,
        "stone_damage": 500
    },
    {
        "description": "unknown1",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Catapult",
        "health": 10000,
        "arrow_damage": 300,
        "xbow_damage": 1500,
        "stone_damage": 200
    },
    {
        "description": "Trebuchet",
        "health": 12000,
        "arrow_damage": 200,
        "xbow_damage": 1000,
        "stone_damage": 150
    },
    {
        "description": "Mangonel",
        "health": 10000,
        "arrow_damage": 1200,
        "xbow_damage": 1500,
        "stone_damage": 1000
    },
    {
        "description": "Trader",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Trader horse",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Deer",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Lion",
        "health": 12000,
        "arrow_damage": 4000,
        "xbow_damage": 10000,
        "stone_damage": 3000
    },
    {
        "description": "Rabbit",
        "health": 1000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Camel",
        "health": 20000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Crow",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Seagull",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Siege tent",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Cow",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Dog",
        "health": 3000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Fireman",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Ghost",
        "health": 500000,
        "arrow_damage": 50,
        "xbow_damage": 50,
        "stone_damage": 50
    },
    {
        "description": "Lord",
        "health": 150000,
        "arrow_damage": 100,
        "xbow_damage": 150,
        "stone_damage": 100
    },
    {
        "description": "Lady",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Jester",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Siege tower",
        "health": 240000,
        "arrow_damage": 3000,
        "xbow_damage": 8000,
        "stone_damage": 2000
    },
    {
        "description": "Battering ram",
        "health": 150000,
        "arrow_damage": 3000,
        "xbow_damage": 8000,
        "stone_damage": 2000
    },
    {
        "description": "Portable shield",
        "health": 10000,
        "arrow_damage": 50,
        "xbow_damage": 150,
        "stone_damage": 10
    },
    {
        "description": "Tower ballista",
        "health": 10000,
        "arrow_damage": 2000,
        "xbow_damage": 3000,
        "stone_damage": 1000
    },
    {
        "description": "Chicken",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Mother",
        "health": 60000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Child",
        "health": 60000,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Juggler",
        "health": 2500,
        "arrow_damage": 15000,
        "xbow_damage": 15000,
        "stone_damage": 5000
    },
    {
        "description": "Fireeater",
        "health": 2500,
        "arrow_damage": 150000,
        "xbow_damage": 15000,
        "stone_damage": 50000
    },
    {
        "description": "Dog",
        "health": 6000,
        "arrow_damage": 4000,
        "xbow_damage": 10000,
        "stone_damage": 2000
    },
    {
        "description": "unknown2",
        "health": 2500,
        "arrow_damage": 0,
        "xbow_damage": 0,
        "stone_damage": 0
    },
    {
        "description": "unknown3",
        "health": 2500,
        "arrow_damage": 0,
        "xbow_damage": 0,
        "stone_damage": 0
    },
    {
        "description": "Arabian archer",
        "health": 12000,
        "arrow_damage": 2000,
        "xbow_damage": 10000,
        "stone_damage": 500
    },
    {
        "description": "Arabian slave",
        "health": 6000,
        "arrow_damage": 7000,
        "xbow_damage": 6000,
        "stone_damage": 4000
    },
    {
        "description": "Arabian slinger",
        "health": 9000,
        "arrow_damage": 4000,
        "xbow_damage": 8000,
        "stone_damage": 3000
    },
    {
        "description": "Arabian assassin",
        "health": 15000,
        "arrow_damage": 1500,
        "xbow_damage": 8000,
        "stone_damage": 500
    },
    {
        "description": "Arabian horse archer",
        "health": 10000,
        "arrow_damage": 1250,
        "xbow_damage": 8000,
        "stone_damage": 500
    },
    {
        "description": "Arabian swordsman",
        "health": 20000,
        "arrow_damage": 300,
        "xbow_damage": 8000,
        "stone_damage": 200
    },
    {
        "description": "Arabian firethrower",
        "health": 7000,
        "arrow_damage": 1250,
        "xbow_damage": 8000,
        "stone_damage": 400
    },
    {
        "description": "Fire ballista",
        "health": 10000,
        "arrow_damage": 500,
        "xbow_damage": 500,
        "stone_damage": 100
    }
];

unitBaseValues = {}

function loadUnitBaseTable(){
    var cellBorderStyle = "solid thin #000000";
    var tableHeaderBorder = "solid #000000";

    var table = document.createElement("table");
    var header = document.createElement("thead");
    var header_row = document.createElement("tr");

    var cell = document.createElement("th");
    cell.scope = "col";
    cell.style.border = tableHeaderBorder;
    cell.innerText = "Unit";
    cell.style.verticalAlign = "bottom";
    header_row.appendChild(cell);


    var cell = document.createElement("th");
    cell.scope = "col";
    cell.style.border = tableHeaderBorder;
    cell.innerText = "Health";
    header_row.appendChild(cell);

    var cell = document.createElement("th");
    cell.scope = "col";
    cell.style.border = tableHeaderBorder;
    cell.innerText = "Arrow Damage";
    header_row.appendChild(cell);

    var cell = document.createElement("th");
    cell.scope = "col";
    cell.style.border = tableHeaderBorder;
    cell.innerText = "Xbow Damage";
    header_row.appendChild(cell);

    var cell = document.createElement("th");
    cell.scope = "col";
    cell.style.border = tableHeaderBorder;
    cell.innerText = "Stone Damage";
    header_row.appendChild(cell);


    header.appendChild(header_row);
    table.appendChild(header);

    var body = document.createElement("tbody");
    for (let i = 0; i < unitBaseStats.length; i++){
        let unitName = unitBaseStats[i]["description"];

        let row = document.createElement("tr");
        let cell = document.createElement("td");
        cell.scope = "row";    
        cell.style.border = cellBorderStyle;
        cell.innerText = unitName;
        row.append(cell);

        /* unit hp input */
        cell = document.createElement("td");
        cell.scope = "row";
        cell.style.border = cellBorderStyle;

        let inputHealth = document.createElement("input");
        inputHealth.placeholder = unitBaseStats[i]["health"];
        inputHealth.value = unitBaseStats[i]["health"];
        inputHealth.type = "number";
        inputHealth.min = 0;
        inputHealth.max = 4294967295;
        inputHealth.style.textAlign = "center";
        cell.append(inputHealth);

        var button = document.createElement("button");
        button.classList.add("btn");
        button.classList.add("btn-info");
        button.innerText = "Reset";
        button.classList.add("unitbase");
        button.style.marginLeft = "10px";
        button.addEventListener("click", function(e){
            inputHealth.value = inputHealth.placeholder;
        });
        cell.append(button);
        row.append(cell);


        /* unit arrow damage input */
        cell = document.createElement("td");
        cell.scope = "row";
        cell.style.border = cellBorderStyle;

        let inputArrow = document.createElement("input");
        inputArrow.placeholder = unitBaseStats[i]["arrow_damage"];
        inputArrow.value = unitBaseStats[i]["arrow_damage"];
        inputArrow.type = "number";
        inputArrow.min = 0;
        inputArrow.max = 4294967295;
        inputArrow.style.textAlign = "center";
        cell.append(inputArrow);

        var button = document.createElement("button");
        button.classList.add("btn");
        button.classList.add("btn-info");
        button.innerText = "Reset";
        button.classList.add("unitbase");
        button.style.marginLeft = "10px";
        button.addEventListener("click", function(e){
            inputArrow.value = inputArrow.placeholder;
        });
        cell.append(button);
        row.append(cell);


        /* unit xbow damage input */
        cell = document.createElement("td");
        cell.scope = "row";
        cell.style.border = cellBorderStyle;

        let inputXbow = document.createElement("input");
        inputXbow.placeholder = unitBaseStats[i]["xbow_damage"];
        inputXbow.value = unitBaseStats[i]["xbow_damage"];
        inputXbow.type = "number";
        inputXbow.min = 0;
        inputXbow.max = 4294967295;
        inputXbow.style.textAlign = "center";
        cell.append(inputXbow);

        var button = document.createElement("button");
        button.classList.add("btn");
        button.classList.add("btn-info");
        button.innerText = "Reset";
        button.classList.add("unitbase");
        button.style.marginLeft = "10px";
        button.addEventListener("click", function(e){
            inputXbow.value = inputXbow.placeholder;
        });
        cell.append(button);
        row.append(cell);


        /* unit arrow damage input */
        cell = document.createElement("td");
        cell.scope = "row";
        cell.style.border = cellBorderStyle;

        let inputStone = document.createElement("input");
        inputStone.placeholder = unitBaseStats[i]["stone_damage"];
        inputStone.value = unitBaseStats[i]["stone_damage"];
        inputStone.type = "number";
        inputStone.min = 0;
        inputStone.max = 4294967295;
        inputStone.style.textAlign = "center";
        cell.append(inputStone);

        var button = document.createElement("button");
        button.classList.add("btn");
        button.classList.add("btn-info");
        button.innerText = "Reset";
        button.classList.add("unitbase");
        button.style.marginLeft = "10px";
        button.addEventListener("click", function(e){
            inputStone.value = inputStone.placeholder;
        });
        cell.append(button);
        row.append(cell);


        /* Define unit value retriever */
        unitBaseValues[unitName] = {};
        unitBaseValues[unitName]["originalHealth"] = () => inputHealth.placeholder;
        unitBaseValues[unitName]["health"] = () => inputHealth.value;
        unitBaseValues[unitName]["originalArrowDamage"] = () => inputArrow.placeholder;
        unitBaseValues[unitName]["arrowDamage"] = () => inputArrow.value;
        unitBaseValues[unitName]["originalXbowDamage"] = () => inputXbow.placeholder;
        unitBaseValues[unitName]["xbowDamage"] = () => inputXbow.value;
        unitBaseValues[unitName]["originalStoneDamage"] = () => inputStone.placeholder;
        unitBaseValues[unitName]["stoneDamage"] = () => inputStone.value;
        
        unitBaseValues[unitName]["value"] = () => {
            let value = {};
            if (unitBaseValues[unitName]["originalHealth"]() != unitBaseValues[unitName]["health"]()){
                value["health"] = unitBaseValues[unitName]["health"]();
            }
            if (unitBaseValues[unitName]["originalArrowDamage"]() != unitBaseValues[unitName]["arrowDamage"]()){
                value["arrowDamage"] = unitBaseValues[unitName]["arrowDamage"]();
            }
            if (unitBaseValues[unitName]["originalXbowDamage"]() != unitBaseValues[unitName]["xbowDamage"]()){
                value["xbowDamage"] = unitBaseValues[unitName]["xbowDamage"]();
            }
            if (unitBaseValues[unitName]["originalStoneDamage"]() != unitBaseValues[unitName]["stoneDamage"]()){
                value["stoneDamage"] = unitBaseValues[unitName]["stoneDamage"]();
            }
            return value;
        };
        body.append(row);
    }
    table.append(body);
    return table;
}

$("#unitbasecontrols").html(loadFilter());
function loadFilter(){
    var container = document.createElement("div");
    container.style.paddingTop = "20px";
    

    var input = document.createElement("input");
    input.placeholder = "Search";
    input.classList.add("form-control");
    input.id = "unitbasefilter";
    input.type = "text";
    input.style.display = "inline-block";
    input.style.width = "150px";
    container.append(input);

    var button = document.createElement("button");
    button.classList.add("btn");
    button.classList.add("btn-info");
    button.style.display = "inline-block";
    button.innerText = "Clear filter";
    button.id = "unitbasefilterclear";
    container.append(button);

    var button = document.createElement("button");
    button.classList.add("btn");
    button.classList.add("btn-warning");
    button.style.display = "inline-block";
    button.innerText = "Reset all";
    button.style.marginLeft = "20px";
    button.addEventListener("click", function(e){
        document.querySelectorAll(".btn").forEach(btn => {
            if (btn != this && btn.classList.contains("unitbase")){
                btn.click();
            }
        })
    });
    container.append(button);
    return container;
}

$("#unitbasefilter").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#unitbasetable tbody tr").filter(function() {
        $(this).toggle($(this).text().replace(new RegExp("Reset", 'g'), "").toLowerCase().indexOf(value) > -1)
    });
});

$("#unitbasefilterclear").on("click", function() {
    $("#unitbasefilter").val("");
    $("#unitbasetable tbody tr").filter(function() {
        $(this).show();
    });
});